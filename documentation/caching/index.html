<!DOCTYPE html>
<html lang="en" class="spf-link no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>SPF - Caching</title>
<meta name="description" content="Custom response caching for greater application flexibility.">

<link rel="canonical" href="http://youtube.github.io/spfjs/documentation/caching/">

<!-- Add to homescreen for Chrome on Android -->
<meta name="mobile-web-app-capable" content="yes">
<link rel="icon" sizes="196x196" href="/spfjs/images/touch/chrome-touch-icon-196x196.png">

<!-- Add to homescreen for Safari on iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="SPF">

<!-- Tile icon for Win8 (144x144 + tile color) -->
<meta name="msapplication-TileImage" content="/spfjs/images/touch/ms-touch-icon-144x144-precomposed.png">
<meta name="msapplication-TileColor" content="#3372DF">

<!-- begin spf head -->
<link rel="stylesheet" name="roboto" href="//fonts.googleapis.com/css?family=Roboto:300,600,900|Roboto+Condensed:300,300italic,400,700|Inconsolata:400">
<link rel="stylesheet" name="wsk" href="/spfjs/assets/vendor/wsk/0.4.0/styles/wsk.css">
<link rel="stylesheet" name="octicons" href="/spfjs/assets/vendor/octicons/2.1.2/octicons.css">
<link rel="stylesheet" name="main" href="/spfjs/assets/styles/main.css?md5=f62c33ff111004a72c322331b82813d9">

<!-- end spf head -->
</head>
<body id="body" class="documentation">

<header id="app-bar" class="app-bar promote-layer">
  <div class="app-bar-container">
    <button id="menu" class="menu" title="Menu"></button>
    <h1 class="logo"><a href="/spfjs/">SPF</a></h1>
    <section class="app-bar-actions">
      <a href="#"><i class="icon octicon octicon-chevron-up"></i> Top</a>
    </section>
  </div>
</header>

<div class="navdrawer">
  <nav id="nav" class="navdrawer-container promote-layer">
    <h4>Navigation</h4>
    
<ul>
  
    <li class="index">
      <a href="/spfjs/">SPF</a>
    </li>
  
    <li >
      <a href="/spfjs/documentation/">Documentation</a>
    </li>
  
    <li >
      <a href="/spfjs/api/">API</a>
    </li>
  
    <li >
      <a href="/spfjs/download/">Download</a>
    </li>
  
  <li><a href="https://github.com/youtube/spfjs">GitHub</a></li>
</ul>

  </nav>
</div>

<div id="content">
<!-- begin spf body: content -->
<main class="clear">

  
  

  <nav class="toc g-wide--1 g-medium--1">
    
  
  
  
    <p class="toc__title">
      <a href="/spfjs/documentation/">Documentation</a>
    </p>
  

<ol class="toc__list list-links">
  
    <li>
      
        <a href="/spfjs/documentation/start/">Get Started</a>
      
      
    </li>
  
    <li>
      
        <a href="/spfjs/documentation/responses/">Responses</a>
      
      
    </li>
  
    <li>
      
        <a href="/spfjs/documentation/events/">Events</a>
      
      
    </li>
  
    <li>
      
        <a href="/spfjs/documentation/resources/">Resources</a>
      
      
    </li>
  
    <li>
      
        <a href="/spfjs/documentation/versioning/">Versioning</a>
      
      
    </li>
  
    <li>
      
        <a href="/spfjs/documentation/caching/">Caching</a>
      
      
    </li>
  
    <li>
      
        <a href="/spfjs/documentation/prefetching/">Prefetching</a>
      
      
    </li>
  
    <li>
      
        <a href="/spfjs/documentation/features/">Features</a>
      
      
        
  
  
  

<ol class="toc__list list-links">
  
    <li>
      
        <a href="/spfjs/documentation/features/multipart/">Multipart Responses</a>
      
      
    </li>
  
</ol>

      
    </li>
  
</ol>


    
      <div class="pagetoc">
        <p class="toc__title">
          <a href="/spfjs/documentation/caching/">Caching</a>
        </p>
        <ul>
<li>
<a href="#when-the-cache-is-used">When the cache is used</a>
</li>
<li>
<a href="#configuring-the-cache">Configuring the cache</a>
</li>
<li>
<a href="#automatic-garbage-collection">Automatic garbage collection</a>
</li>
<li>
<a href="#manually-adjusting-the-cache">Manually adjusting the cache</a>
</li>
</ul>

      </div>
    
  </nav>

  

    <article class="g-wide--3 g-wide--last g-medium--2 g-medium--last">
      <header class="page-header container">
        <h2 class="xxlarge text-divider">Caching</h2>
        
          <p class="page-header__excerpt g-wide--push-1 g-wide--pull-1">
            Custom response caching for greater application flexibility.
          </p>
        
      </header>
      <div class="container">
        <p>When building a complex web application, sometimes you want more
flexibility than standard HTTP based caching in order to best
balance your application logic with performance.  SPF provides
a local configurable response cache that you can adjust as
needed.</p>

<h2 id="when-the-cache-is-used">When the cache is used</h2>

<p>Before making a request, SPF checks the local cache to see if a
valid cached response is available for the requested URL.  If
one is found, then it will be used instead of sending a request
over the network.  If not, after the response is received, SPF
will place that response in the local cache for future use.</p>

<p>By default, SPF uses a caching model that matches the
back-forward cache in browsers: &quot;new&quot; navigation will not use a
previously cached response, whereas &quot;history&quot; navigation will.
This means that your server will receive requests for every link
click, for example, but not for back button uses.  However, if
the <code>cache-unified</code> config value is set to <code>true</code>, then SPF will
use an available cache response for all navigations.  This will
mean that your server will not receive requests for link clicks
that are to previously visited pages, just like for back button
presses.</p>

<p>When <a href="../prefetching/">prefetching</a> responses, by default, SPF will place a
prefetched response in the local cache as eligible for one &quot;new&quot;
navigation.  After that one use, the cached response will only
be eligible for &quot;history&quot; navigation.  However, if the
<code>cache-unified</code> config value is set to <code>true</code>, then the
prefetched response will be available for all navigations like
other cached responses.</p>

<h2 id="configuring-the-cache">Configuring the cache</h2>

<p>You may configure the cache using parameters to control the
total number and lifetime of entries in the cache.  Increasing
these settings will increase the chance of finding a valid,
cached response and also consume more memory in the browser.
Conversely, decreasing these settings will decrease the chance
of finding a valid cached response and also consume less memory
in the browser.  A list of the configuration parameters and
their descriptions follows:</p>

<p><strong><code>cache-lifetime</code></strong><br>
The maximum time in milliseconds a cache entry is considered
valid.  Defaults to <code>600000</code> (10 minutes).</p>

<p><strong><code>cache-max</code></strong><br>
The maximum number of total cache entries.  Defaults to <code>50</code>.</p>

<p><strong><code>cache-unified</code></strong><br>
Whether to unify all cache responses instead of separating them
by use (e.g. history, prefetching). Defaults to <code>false</code>.</p>

<h2 id="automatic-garbage-collection">Automatic garbage collection</h2>

<p>The cache performs automatic garbage collection by removing
entries at two times:</p>

<ol>
<li><p>If a requested entry is found but it is expired according to
the configured lifetime, the entry is removed from the cache
instead of being used.</p></li>
<li><p>Each time a new entry is added, the
cache does asynchronous garbage collection.  This garbage
collection first removes all expired entries, then if needed, it
removes entries in the cache that exceed the configured maximum
size with a least-recently-used (LRU) policy.</p></li>
</ol>

<h2 id="manually-adjusting-the-cache">Manually adjusting the cache</h2>

<p>Sometimes you might need to manually remove an entry from the
cache.  For example, a user might take an action on the page
that changes it, and you would like future requests to reflect
that action; by making the next request the server, the response
will stay in sync.</p>

<p>Each <a href="../../events/#event-descriptions">spfdone</a> event specifies a <code>cacheKey</code> attribute in the
<a href="../../../api/#spf.singleresponse">response object</a>.  You can use this <code>cacheKey</code> to reference a
specific cache entry when calling API functions that manipulate
the cache.  A list of API functions and their descriptions
follow:</p>

<p><strong><code>spf.cache.remove(key)</code></strong><br>
Removes an entry from the cache.  Pass a <code>cacheKey</code> from a
response object to reference the entry you wish to remove.  See
also the API reference for <a href="../../../api/#spf.cache.remove">spf.cache.remove</a>.</p>

<p><strong><code>spf.cache.clear()</code></strong><br>
Removes all entries from the cache.  See also the API reference
for <a href="../../../api/#spf.cache.clear">spf.cache.clear</a>.</p>

      </div>
      

  






<nav class="article-nav">
  
    <a href="/spfjs/documentation/versioning/" class="article-nav-link article-nav-link--prev">
      <p class="article-nav-count">Versioning</p>
      
        <p class="article-nav-description">Automatically update script and style versions.</p>
      
    </a>
  
  
    <a href="/spfjs/documentation/prefetching/" class="article-nav-link article-nav-link--next">
      <p class="article-nav-count">Prefetching</p>
      
        <p class="article-nav-description">Prefetch responses before they're requested.</p>
      
    </a>
  
</nav>

    </article>

  


  <section class="feedback">
    <footer class="container"><div class="container">
      <p>
        If you have feedback, comments, or questions about SPF, please send them
        to <a href="mailto:spfjs@googlegroups.com">spfjs@googlegroups.com</a>.
        If you have bugs or feature requests, please file them on
        <a href="https://github.com/youtube/spfjs/issues">GitHub</a>. Join our
        <a href="https://groups.google.com/group/spfjs">mailing list</a> and
        follow <a href="https://twitter.com/spfjs">@spfjs</a> on Twitter for
        updates.
      </p>
    </div></footer>
  </section>

</main>

<!-- end spf body: content -->
</div>

<footer>
  <div class="container">
    <p class="small">
      &copy; 2014 Google.
      Code licensed under <a href="https://github.com/youtube/spfjs/blob/master/LICENSE">MIT</a>.
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
    </p>
  </div>
</footer>

<div id="progress"><dt></dt><dd></dd></div>

<!-- begin spf foot -->
<script name="spf" src="/spfjs/assets/vendor/spf/2.1.1/spf.js"></script>
<script name="main" src="/spfjs/assets/scripts/main.js?md5=41d2d6b89469117ea1c212e0183988b7"></script>

<script name="analytics">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
</script>
<script>
  if (window.location.hostname == 'youtube.github.io') {
    ga('create', 'UA-52278317-1', 'auto');
    ga('send', 'pageview');
  }
</script>

<!-- end spf foot -->
</body>
</html>
