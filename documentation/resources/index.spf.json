{
  "title": "SPF - Resources",
  "head": "\n<link rel=\"stylesheet\" name=\"roboto\" href=\"//fonts.googleapis.com/css?family=Roboto:300,600,900|Roboto+Condensed:300,300italic,400,700|Inconsolata:400\">\n<link rel=\"stylesheet\" name=\"wsk\" href=\"/spfjs/assets/vendor/wsk/0.4.0/styles/wsk.css\">\n<link rel=\"stylesheet\" name=\"octicons\" href=\"/spfjs/assets/vendor/octicons/2.1.2/octicons.css\">\n<link rel=\"stylesheet\" name=\"main\" href=\"/spfjs/assets/styles/main.css?t=2015-05-22T11%3A03%3A10-04%3A00\">\n\n",
  "body": {
    "content": "\n<main class=\"clear\">\n\n  <nav class=\"toc g-wide--1 g-medium--1\">\n    \n  \n  \n  \n    <p class=\"toc__title\">\n      <a href=\"/spfjs/documentation/\">Documentation</a>\n    </p>\n  \n\n<ol class=\"toc__list list-links\">\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/start/\">Get Started</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/responses/\">Responses</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/events/\">Events</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/resources/\">Resources</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/versioning/\">Versioning</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/\">Features</a>\n      \n      \n        \n  \n  \n  \n\n<ol class=\"toc__list list-links\">\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/caching/\">Caching</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/multipart/\">Multipart Responses</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/prefetching/\">Prefetching</a>\n      \n      \n    </li>\n  \n</ol>\n\n      \n    </li>\n  \n</ol>\n\n  </nav>\n\n  \n  \n\n  \n\n    <article class=\"g-wide--3 g-wide--last g-medium--2 g-medium--last\">\n      <header class=\"page-header container\">\n        <h2 class=\"xxlarge text-divider\">Resources</h2>\n        \n          <p class=\"page-header__excerpt g-wide--push-1 g-wide--pull-1\">\n            Manage script and style loading.\n          </p>\n        \n      </header>\n      <div class=\"container\">\n        <p>As briefly mentioned in the <a href=\"../responses/\">Responses overview</a>,\nwhen SPF processes a response, it will install JS and CSS from\nthe <code>head</code> fragment, any of the <code>body</code> fragments, and the <code>foot</code>\nfragment.  However, SPF has two methods of handling scripts and\nstyles: unmanaged and managed.  Both are detailed below.</p>\n\n<h2 id=\"unmanaged-resources\">Unmanaged Resources</h2>\n\n<p>SPF parses each fragment for scripts and styles, extracts them,\nand executes them by appending them to the <code>&lt;head&gt;</code> of the\ndocument.  For example, given the following response:</p>\n<div class=\"highlight\"><pre><code class=\"language-json\" data-lang=\"json\"><span class=\"p\">{</span>\n  <span class=\"nt\">&quot;head&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;</span>\n<span class=\"s2\">    &lt;style&gt;.foo { color: blue }&lt;/style&gt;</span>\n<span class=\"s2\">    &lt;link href=\\&quot;file.css\\&quot; rel=\\&quot;stylesheet\\&quot;&gt;</span>\n<span class=\"s2\">  &quot;</span><span class=\"p\">,</span>\n  <span class=\"nt\">&quot;body&quot;</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"nt\">&quot;element-id-a&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;Lorem ipsum dolor sit amet&quot;</span><span class=\"p\">,</span>\n    <span class=\"nt\">&quot;element-id-b&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;consectetur adipisicing elit&quot;</span>\n  <span class=\"p\">},</span>\n  <span class=\"nt\">&quot;foot&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;</span>\n<span class=\"s2\">    &lt;script src=\\&quot;file.js\\&quot;&gt;&lt;/script&gt;</span>\n<span class=\"s2\">    &lt;script&gt;alert(&#39;hello&#39;);&lt;/script&gt;</span>\n<span class=\"s2\">  &quot;</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<p>Then, when SPF processes this response, it will do the following\nsteps:</p>\n\n<ol>\n<li> Append <code>&lt;style&gt;.foo { color: blue }&lt;/style&gt;</code> to the document\n<code>&lt;head&gt;</code> to eval the CSS.</li>\n<li> Append <code>&lt;link href=&quot;file.css&quot; rel=&quot;stylesheet&quot;&gt;</code> to the\ndocument <code>&lt;head&gt;</code> to load the CSS file.</li>\n<li> Update the element with DOM id <code>element-id-a</code> with the HTML\n<code>Lorem ipsum dolor sit amet</code>.</li>\n<li> Update the element with DOM id <code>element-id-b</code> with the HTML\n<code>consectetur adipisicing elit</code>.</li>\n<li> Append <code>&lt;script src=&quot;file.js&quot;&gt;&lt;/script&gt;</code> to the document\n<code>&lt;head&gt;</code> to load the JS file <strong>and wait for it to complete\nbefore continuing</strong>.</li>\n<li> Append <code>&lt;script&gt;alert(&#39;hello&#39;);&lt;/script&gt;</code> to the document\n<code>&lt;head&gt;</code> to eval the JS.</li>\n</ol>\n\n<blockquote>\n<p><strong>Note:</strong> SPF will wait for script loading or execution to\ncomplete before processing.  This matches browser behavior and\nensures proper script execution order.  (See step 4 above.)\nTo not wait for script execution, add the <code>async</code> attribute:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;file.js&quot;</span> <span class=\"na\">async</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div></blockquote>\n\n<p>As you navigate to and from the page sending this response,\nthese steps will be repeated each time.</p>\n\n<h2 id=\"managed-resources\">Managed Resources</h2>\n\n<p>However, a significant benefit of SPF is that only sections of\nthe page are updated with each navigation instead of the browser\nperforming a full reload.  That means — almost certainly — not\nevery script and style needs to be executed or loaded during\nevery navigation.</p>\n\n<p>Consider the following common pattern where two scripts are\nloaded per page: one containing common library code (e.g.\njQuery) and a second containing page-specific code.   For\nexample, a search page and an item page:</p>\n\n<p>Search Page:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"c\">&lt;!-- common-library.js provides utility functions --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;common-library.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n<span class=\"c\">&lt;!-- search-page.js provides functions for the search page --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;search-page.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div>\n<p>Item Page:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"c\">&lt;!-- common-library.js provides utility functions --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;common-library.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n<span class=\"c\">&lt;!-- item-page.js provides functions for the item page --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">src=</span><span class=\"s\">&quot;item-page.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div>\n<p>As a user navigates from the search page to the item page, the\n<code>common-library.js</code> file does not need to be loaded again, as\nit&#39;s already in the page.  You can instruct SPF to manage this\nscript by giving it a <code>name</code> attribute.  Then, when it\nencounters the script again, it will not reload it:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;common&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;common-library.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div>\n<p>By applying this to all the scripts, a user can navigate back\nand forth between the two pages and only ever load a given file\nonce:</p>\n\n<p>Search Page:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;common&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;common-library.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;search&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;search-page.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div>\n<p>Item Page:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;common&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;common-library.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;item&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;item-page.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div>\n<p>Now, given the following navigation flow:</p>\n<div class=\"highlight\"><pre><code class=\"language-text\" data-lang=\"text\">[ search ]---&gt;[ item ]---&gt;[ search ]---&gt;[ item ]\n</code></pre></div>\n<p>Then, when SPF processes the responses for each page in that\nflow, it will do the following steps:</p>\n\n<ol>\n<li> <strong>Navigate to the search page.</strong></li>\n<li> Load the <code>common-library.js</code> JS file and wait for it to\ncomplete before continuing.</li>\n<li> Load the <code>search-page.js</code> JS file and wait for it to\ncomplete before continuing.</li>\n<li> <strong>Navigate to the item page.</strong></li>\n<li> <em>Skip reloading <code>common-library.js</code>.</em></li>\n<li> Load the <code>item-page.js</code> JS file and wait for it to complete\nbefore continuing.</li>\n<li> <strong>Navigate to the search page.</strong></li>\n<li> <em>Skip reloading <code>common-library.js</code>.</em></li>\n<li> <em>Skip reloading <code>search-page.js</code>.</em></li>\n<li><strong>Navigate to the item page.</strong></li>\n<li><em>Skip reloading <code>common-library.js</code>.</em></li>\n<li><em>Skip reloading <code>item-page.js</code>.</em></li>\n</ol>\n\n<p>Navigation between the two pages now avoids unnecessarily\nreloading the scripts.</p>\n\n<blockquote>\n<p><strong>Note:</strong> See the <a href=\"../events/\">Events</a> documentation to properly\nhandle initialization and disposal of pages during navigation\nto avoid memory leaks and outdated event listeners.</p>\n\n<p><strong>Note:</strong> See the <a href=\"../versioning/\">Versioning</a> documentation to\nautomatically switch between script and style versions for seamless\nreleases.</p>\n</blockquote>\n\n      </div>\n      \n\n  \n\n\n\n\n\n\n<nav class=\"article-nav\">\n  \n    <a href=\"/spfjs/documentation/events/\" class=\"article-nav-link article-nav-link--prev\">\n      <p class=\"article-nav-count\">Events</p>\n      \n        <p class=\"article-nav-description\">Handle SPF events and the navigation life cycle.</p>\n      \n    </a>\n  \n  \n    <a href=\"/spfjs/documentation/versioning/\" class=\"article-nav-link article-nav-link--next\">\n      <p class=\"article-nav-count\">Versioning</p>\n      \n        <p class=\"article-nav-description\">Automatically update script and style versions.</p>\n      \n    </a>\n  \n</nav>\n\n    </article>\n\n  \n\n\n  <section class=\"feedback\">\n    <footer class=\"container\"><div class=\"container\">\n      <p>\n        If you have feedback, comments, or questions about SPF, please send them\n        to <a href=\"mailto:spfjs@googlegroups.com\">spfjs@googlegroups.com</a>.\n        If you have bugs or feature requests, please file them on\n        <a href=\"https://github.com/youtube/spfjs/issues\">GitHub</a>. Join our\n        <a href=\"https://groups.google.com/group/spfjs\">mailing list</a> and\n        follow <a href=\"https://twitter.com/spfjs\">@spfjs</a> on Twitter for\n        updates.\n      </p>\n    </div></footer>\n  </section>\n\n</main>\n\n"
  },
  "attr": {
    "body": {
      "class": "documentation"
    }
  },
  "foot": "\n<script name=\"spf\" src=\"/spfjs/assets/vendor/spf/2.1.1/spf.js\"></script>\n<script name=\"main\" src=\"/spfjs/assets/scripts/main.js?t=2015-05-22T11%3A03%3A10-04%3A00\"></script>\n\n<script name=\"analytics\">\n  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n</script>\n<script>\n  if (window.location.hostname == 'youtube.github.io') {\n    ga('create', 'UA-52278317-1', 'auto');\n    ga('send', 'pageview');\n  }\n</script>\n\n"
}