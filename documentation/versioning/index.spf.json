{
  "title": "SPF - Versioning",
  "head": "\n<link rel=\"stylesheet\" name=\"roboto\" href=\"//fonts.googleapis.com/css?family=Roboto:300,600,900|Roboto+Condensed:300,300italic,400,700|Inconsolata:400\">\n<link rel=\"stylesheet\" name=\"wsk\" href=\"/spfjs/assets/vendor/wsk/0.4.0/styles/wsk.css\">\n<link rel=\"stylesheet\" name=\"octicons\" href=\"/spfjs/assets/vendor/octicons/2.1.2/octicons.css\">\n<link rel=\"stylesheet\" name=\"main\" href=\"/spfjs/assets/styles/main.css?t=2015-05-21T14%3A11%3A39-04%3A00\">\n\n",
  "body": {
    "content": "\n<main class=\"clear\">\n\n  <nav class=\"toc g-wide--1 g-medium--1\">\n    \n  \n  \n  \n    <p class=\"toc__title\">\n      <a href=\"/spfjs/documentation/\">Documentation</a>\n    </p>\n  \n\n<ol class=\"toc__list list-links\">\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/start/\">Get Started</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/responses/\">Responses</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/events/\">Events</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/resources/\">Resources</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/versioning/\">Versioning</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/\">Features</a>\n      \n      \n        \n  \n  \n  \n\n<ol class=\"toc__list list-links\">\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/caching/\">Caching</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/multipart/\">Multipart Responses</a>\n      \n      \n    </li>\n  \n    <li>\n      \n        <a href=\"/spfjs/documentation/features/prefetching/\">Prefetching</a>\n      \n      \n    </li>\n  \n</ol>\n\n      \n    </li>\n  \n</ol>\n\n  </nav>\n\n  \n  \n\n  \n\n    <article class=\"g-wide--3 g-wide--last g-medium--2 g-medium--last\">\n      <header class=\"page-header container\">\n        <h2 class=\"xxlarge text-divider\">Versioning</h2>\n        \n          <p class=\"page-header__excerpt g-wide--push-1 g-wide--pull-1\">\n            Automatically update script and style versions.\n          </p>\n        \n      </header>\n      <div class=\"container\">\n        <p>When using dynamic navigation, SPF transforms your site from\nshort-lived pages into a long-lived application.  When building\na long-lived application, an important concern is how to push\nnew code -- you don&#39;t want old JS attempting to interact with new\nHTML or new CSS applying to old HTML.  SPF can automatically\nupdate your script and style versions to ensure they stay in\nsync with your content.</p>\n\n<blockquote>\n<p><strong>Note:</strong> Automatic versioning only applies to\n<a href=\"../resources/#managed-resources\">managed resources</a>.</p>\n</blockquote>\n\n<p>As an example, consider a user currently on your site who\nstarted with yesterday&#39;s code.  If you push updated scripts and\ncontent, the user will transition to the new content and needs\nthe updated scripts as well.</p>\n\n<h2 id=\"use-unique-urls-for-each-version\">Use unique URLs for each version</h2>\n\n<p>You can can instruct SPF to\n<a href=\"../resources/#managed-resources\">manage a resource</a> by giving it a <code>name</code>\nattribute:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"c\">&lt;!-- external script --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;common&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;common-library.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n<span class=\"c\">&lt;!-- inline script --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;page&quot;</span><span class=\"nt\">&gt;</span><span class=\"cm\">/* Page-specific script. */</span><span class=\"nt\">&lt;/script&gt;</span>\n<span class=\"c\">&lt;!-- external style --&gt;</span>\n<span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;common&quot;</span> <span class=\"na\">rel=</span><span class=\"s\">&quot;stylesheet&quot;</span> <span class=\"na\">href=</span><span class=\"s\">&quot;common-styles.css&quot;</span><span class=\"nt\">&gt;</span>\n<span class=\"c\">&lt;!-- inline style --&gt;</span>\n<span class=\"nt\">&lt;style </span><span class=\"na\">name=</span><span class=\"s\">&quot;page&quot;</span><span class=\"nt\">&gt;</span><span class=\"c\">/* Page-specific style. */</span><span class=\"nt\">&lt;/style&gt;</span>\n</code></pre></div>\n<p>When navigating between pages, a named resource will only be\nloaded once.  To detect updates, SPF tracks the external URL or\ninline text associated with each resource name.  If when\nprocessing response a changed URL or text is discovered, SPF\nwill unload the existing resource and load the new one.</p>\n\n<p>To guarantee SPF switches between the old and new versions of\nyour scripts and styles, use a unique URL each time.  For\nexample, for the user currently on your site with yesterday&#39;s\ncode, they might have been served HTML like the following:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"c\">&lt;!-- old version --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;common&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;common-library-v1.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div>\n<p>Then, when you push updated scripts and content, update the URL\nas well:</p>\n<div class=\"highlight\"><pre><code class=\"language-html\" data-lang=\"html\"><span class=\"c\">&lt;!-- new version --&gt;</span>\n<span class=\"nt\">&lt;script </span><span class=\"na\">name=</span><span class=\"s\">&quot;common&quot;</span> <span class=\"na\">src=</span><span class=\"s\">&quot;common-library-v2.js&quot;</span><span class=\"nt\">&gt;&lt;/script&gt;</span>\n</code></pre></div>\n<blockquote>\n<p><strong>Note:</strong> SPF will automatically detect when the content of\nmanaged inline scripts and styles are updated by tracking a\nquick hash of the text content.  Whitespace is ignored when\ncalculating the hash, so indentation and formatting changes\nwill not trigger updates.</p>\n</blockquote>\n\n<h2 id=\"resource-events\">Resource events</h2>\n\n<p>If you need to handle resources being unloaded when a new\nversion is detected, (e.g. to dispose event listeners, etc), SPF\nwill dispatch events before and after a resource is removed.\nAs with those detailed in the <a href=\"../events/\">Events</a> documentation,\nthese events are defined in the <a href=\"../../api/\">API</a> as <a href=\"../../api/#spf.event\">spf.Event</a>\nobjects.  The events and their descriptions follow:</p>\n\n<p><strong><code>spfcssbeforeunload</code></strong><br>\nFired before unloading a managed style resource.  Occurs when\nan updated style is discovered for a given name.</p>\n\n<p><strong><code>spfcssunload</code></strong><br>\nFired when unloading a managed style resource.  If the style\nis being unloaded as part of switching versions, unloading of\nthe old style occurs after the new style is loaded to avoid\nflashes of unstyled content.</p>\n\n<p><strong><code>spfjssbeforeunload</code></strong><br>\nFired before unloading a managed script resource.  Occurs when\nan updated script is discovered for a given name.</p>\n\n<p><strong><code>spfjsunload</code></strong><br>\nFired when unloading a managed script resource.  If the script\nis being unloaded as part of switching versions, unloading of\nthe old script occurs after the new script is loaded for\nconsistency with style loading.</p>\n\n      </div>\n      \n\n  \n\n\n\n\n\n\n<nav class=\"article-nav\">\n  \n    <a href=\"/spfjs/documentation/resources/\" class=\"article-nav-link article-nav-link--prev\">\n      <p class=\"article-nav-count\">Resources</p>\n      \n        <p class=\"article-nav-description\">Manage script and style loading.</p>\n      \n    </a>\n  \n  \n    <a href=\"/spfjs/documentation/features/\" class=\"article-nav-link article-nav-link--next\">\n      <p class=\"article-nav-count\">Features</p>\n      \n        <p class=\"article-nav-description\">Learn about SPF features to enable high performance.</p>\n      \n    </a>\n  \n</nav>\n\n    </article>\n\n  \n\n\n  <section class=\"feedback\">\n    <footer class=\"container\"><div class=\"container\">\n      <p>\n        If you have feedback, comments, or questions about SPF, please send them\n        to <a href=\"mailto:spfjs@googlegroups.com\">spfjs@googlegroups.com</a>.\n        If you have bugs or feature requests, please file them on\n        <a href=\"https://github.com/youtube/spfjs/issues\">GitHub</a>. Join our\n        <a href=\"https://groups.google.com/group/spfjs\">mailing list</a> and\n        follow <a href=\"https://twitter.com/spfjs\">@spfjs</a> on Twitter for\n        updates.\n      </p>\n    </div></footer>\n  </section>\n\n</main>\n\n"
  },
  "attr": {
    "body": {
      "class": "documentation"
    }
  },
  "foot": "\n<script name=\"spf\" src=\"/spfjs/assets/vendor/spf/2.1.1/spf.js\"></script>\n<script name=\"main\" src=\"/spfjs/assets/scripts/main.js?t=2015-05-21T14%3A11%3A39-04%3A00\"></script>\n\n<script name=\"analytics\">\n  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n</script>\n<script>\n  if (window.location.hostname == 'youtube.github.io') {\n    ga('create', 'UA-52278317-1', 'auto');\n    ga('send', 'pageview');\n  }\n</script>\n\n"
}